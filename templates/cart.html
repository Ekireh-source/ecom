{% load static %}
{% load cart_template_tags %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Sun E-commerce</title>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <style>
      .price-box
      {
        width: 100%;
        height: 100px;
        padding-bottom: 20px;
        padding-top: 20px;
        box-shadow: rgba(0, 0, 0, 0.17) 0px -23px 25px 0px inset, rgba(0, 0, 0, 0.15) 0px -36px 30px 0px inset, rgba(0, 0, 0, 0.1) 0px -79px 40px 0px inset, rgba(0, 0, 0, 0.06) 0px 2px 1px, rgba(0, 0, 0, 0.09) 0px 4px 2px, rgba(0, 0, 0, 0.09) 0px 8px 4px, rgba(0, 0, 0, 0.09) 0px 16px 8px, rgba(0, 0, 0, 0.09) 0px 32px 16px;
        margin-bottom: 80px;
        border: 0;
      }

      .pt{
        padding-top: 60px;
      }

      .icon1{
        color: #000;
        font-weight: 400;
      }
    </style>
  
  </head>
  <body>
    <nav class="navbar navbar-expand-lg">
            
          
      <div class="container d-flex flex-wrap">
          <!-- <button class="navbar-toggler navbar-brand" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button> -->

        <ul class="nav me-auto">
          <li class="nav-item"><a href="{% url 'core:home' %}" class="nav-link link-dark px-2 active" aria-current="page">
              <svg xmlns="http://www.w3.org/2000/svg" width="60" height="40" fill="currentColor" class="bi bi-columns-gap text-dark" viewBox="0 0 16 16">
                  <path d="M6 1v3H1V1h5zM1 0a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1H1zm14 12v3h-5v-3h5zm-5-1a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-5zM6 8v7H1V8h5zM1 7a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H1zm14-6v7h-5V1h5zm-5-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1h-5z"/>
                </svg>

          </a></li>
          <li class="nav-item"><a href="{% url 'core:home' %}" class="nav-link link-dark px-2 pt-3 active" aria-current="page"><strong>Home</strong></a></li>
          <li class="nav-item"><a class="nav-link link-dark px-2 pt-3 active" aria-current="page"><strong>Welcome {{ request.user.first_name }}</strong></a></li>
        </ul>
        <ul class="nav"> 
          {% if user.is_authenticated %}
          <li class="nav-item text-black"><a href="{% url 'core:order_summary' %}" class="nav-link link-dark ">
              <span class="badge red z-depth-1 text-dark"> {{ request.user|cart_item_count }} </span>
              <span class="clearfix d-none d-sm-inline-block text-dark"> Cart </span>
              <svg xmlns="http://www.w3.org/2000/svg" width="60" height="30" fill="currentColor" class="bi bi-cart3 text-dark pb-1" viewBox="0 0 16 16">
                  <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
              </svg>
              
          </a></li>
        
          <a  href="{% url 'accounts:logout' %}">
            <li class="nav-item">
              <li class="nav-item"><button type="button" class="btn btn-outline-danger me-2 text-dark">Log-Out</button></li>
            </li>
          </a>
          {% else %}
          <a  href="{% url 'accounts:login' %}">
            <li class="nav-item">
              <button type="button" class="btn btn-outline-success me-2 text-dark">Login</button>
            </li>
          </a>
          <a  href="{% url 'accounts:register' %}">
            <li class="nav-item">
              <li class="nav-item"><button type="button" class="btn btn-outline-success me-2 text-dark">Sign-up</button></li>
            </li>
          </a>
          {% endif %}
          
          
        </ul>
      </div>
    </nav>
       
        </div>
        
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
          </button>
        </div>
        {% endfor %}
        {% endif %}
        

    


    <div class="container my-5 py-5">
      {% if object.get_total %}
      <div class="container price-box">
        <div class="row">
          <div class="col text-start">Items : {{ request.user|cart_item_count }}</div>
          <div class="col text-center">Order Total : Shs. {{object.get_total}}</div>
          <div class="col text-end">
            <a class='btn btn-warning float-right ml-2' href=''>Proceed to checkout</a>
          </div>
          
        </div>
        {% endif %}
      </div>
      <table class="table pt">
        <thead>
          <tr>
            <th scope="col">#</th>
            <!-- <th scope="col">Image</th> -->
            <th scope="col">Item</th>
            <th scope="col">Price</th>
            <th scope="col">Quantity</th>
            <th scope="col">Total</th>
          </tr>
        </thead>
        <tbody>
          {% for order_item in object.items.all %}
          
          <tr>
            <th scope="row" class="">{{ forloop.counter }}</th>
            <!-- <td>{{ order_item.item.image }}</td> -->
            <td>{{ order_item.item.title }}</td>
            {% if order_item.item.discount_price %}
              <td>Shs. {{ order_item.item.discount_price }}</td>
            {% else %}
              <td>Shs. {{ order_item.item.price }}</td>
            {% endif %}
            
            <td>
              <a class="icon1" href="{% url 'core:remove_single_item_from_cart' order_item.item.slug %}"><b>-</b></a>
             
              
              {{ order_item.quantity }}
              <a class="icon1" href="{% url 'core:add_to_cart' order_item.item.slug %}"><b>+</b></a>
              
            </td>
            {% if order_item.item.discount_price %}
            <td>Shs. {{ order_item.get_item_discount_price }}      
              <a href="{% url 'core:remove_from_cart' order_item.item.slug %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                  <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
              </a>
              
            </td>
            {% else %}
            <td>Shs. {{ order_item.get_item_price }}         
              <a href="{% url 'core:remove_from_cart' order_item.item.slug %}">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
                  <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                  <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                </svg>
              </a>
            {% endif %}
            
          </tr>
          {% empty %}
              <tr>
                  <td colspan='5'>Your cart is empty</td>
              </tr>
              <tr>
                  <td colspan="5">
                  <a class='btn btn-success opacity-75% float-right' href='{% url "core:home" %}'>Continue shopping</a>
                  </td>
              </tr>
          {% endfor %}
         
          {% if object.get_total %}
            <tr>
                <td colspan="5">
                <a class='btn btn-primary float-end' href='{% url "core:home" %}'>Continue shopping</a>
                </td>
            </tr>

            {% endif %}
        </tbody>
      </table>
      
        </div>

        </div>
    </div>
       <!-- JavaScript Bundle with Popper -->
       <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
  </body>
</html>